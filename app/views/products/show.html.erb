<h1><%= @title %></h1>
<div class="table-master">
<table class='table table-hover'>
  <tr>
    <td class="table-headers">
      Product
    </td>
    <td>
      <%= @product.name %>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Sold By:
    </td>
    <td>
      <%= @product.user.username%>
    </td>
  </tr>
  <tr>
  <tr>
    <td class="table-headers">
      Description
    </td>
    <td>
      <%= @product.description%>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Price
    </td>
    <td>
      <%= @product.price %>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Photo
    </td>
    <td>
      <%= image_tag @product.photo_url %>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Stock
    </td>
    <td>
      <%= @product.stock%>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Category
    </td>
    <td>
      <% @product.categories.each do |category| %>
      <%= category.name %>
      <% end %>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Average Rating
    </td>
    <td>
    <% if @stars == 5 %>
      <% 5.times do %>
        <i class="fa fa-star"></i>
      <% end %>
    <% else %>
      <% @stars.times do %>
        <i class="fa fa-star"></i>
      <% end %>
      <% (5 - @stars).times do %>
        <i class="fa fa-star-o"></i>
      <% end %>
    <% end %>
    </td>
  </tr>
  <tr>
    <td class="table-headers">
      Reviews
    </td>
    <td>
      <% @product.reviews.each do |rev| %>
      Rating:
      <% if rev.rating == 5 %>
        <% rev.rating.times do %>
          <i class="fa fa-star"></i>
        <% end %>
      <% else %>
        <% rev.rating.times do %>
          <i class="fa fa-star"></i>
        <% end %>
        <% (5 - rev.rating).times do %>
            <i class="fa fa-star-o"></i>
        <% end %>
      <% end %>
      <p class="rating"><%= rev.body %></p>
      <% end %>
    </td>
  </tr>
</table>
</div>

<% if @current_user == nil %>
  <%= form_for @review, url: product_review_path(@product), :html => { :class => "sub-form" } do |f| %>
  <fieldset>
    <div class="sub-form-group">
      <%= f.label :rating, "Rate It:" %>
      <%= f.select :rating, [1, 2, 3, 4, 5], class: "sub-form-control" %>
      <%= f.label :body, "Tell us why" %>
      <%= f.text_area :body, class: "sub-form-control" %>
      <%= f.submit class: "btn btn-default" %>
    </div>
  </fieldset>
  <% end %>
<% end %>


<% unless @product.user_id == @current_user.id %>
  <%= button_to "Add to Cart", buy_path(@product.id), class: "btn btn-default" %>
<% end %>
<% if @current_user != nil %>
  <%= button_to "Edit", edit_product_path(@product), method: :get, class: "btn btn-default" %>
  <%= button_to "Delete", product_path(@product.id), method: :delete, class: "btn btn-default" %>
<% end %>
<%= button_to "All Products", products_path, method: :get, class: "btn btn-default" %>
